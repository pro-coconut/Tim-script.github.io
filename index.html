<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ScriptBlox Mini</title>

<style>
body{
  margin:0;
  font-family: Arial, Helvetica, sans-serif;
  background:#0f0f0f;
  color:white;
}

header{
  padding:15px;
  text-align:center;
  font-size:22px;
  font-weight:bold;
  background:#1a1a1a;
}

.search-box{
  padding:15px;
  text-align:center;
}

.search-box input{
  width:80%;
  max-width:500px;
  padding:12px;
  font-size:16px;
  border-radius:8px;
  border:none;
  outline:none;
}

.section-title{
  font-size:20px;
  margin:20px 15px 10px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(170px,1fr));
  gap:15px;
  padding:15px;
}

.card{
  background:#1b1b1b;
  border-radius:10px;
  overflow:hidden;
  cursor:pointer;
  transition:0.2s;
}

.card:hover{
  transform:scale(1.03);
}

.card img{
  width:100%;
  height:120px;
  object-fit:cover;
  background:#222;
}

.card .info{
  padding:10px;
}

.card .title{
  font-size:14px;
  font-weight:bold;
  height:38px;
  overflow:hidden;
}

.card .game{
  font-size:12px;
  color:#aaa;
  margin-top:4px;
}
</style>
</head>

<body>

<header>ScriptBlox Mini</header>

<div class="search-box">
  <input id="searchInput" placeholder="Tìm script..." />
</div>

<div class="section-title">Script mới nhất</div>
<div id="latest" class="grid"></div>

<div class="section-title">Kết quả tìm kiếm</div>
<div id="results" class="grid"></div>

<script>
const API_BASE = "https://scriptblox.com/api/script";

// Tạo card script
function createCard(script){
  const img = script.image || script.thumbnail || "https://i.imgur.com/8Km9tLL.png";

  return `
  <div class="card" onclick="openScript('${script.slug}')">
    <img src="${img}">
    <div class="info">
      <div class="title">${script.title}</div>
      <div class="game">${script.game?.name || "Unknown Game"}</div>
    </div>
  </div>`;
}

function openScript(slug){
  window.location.href = "view.html?slug=" + slug;
}

// Load script mới nhất
async function loadLatest(){
  const res = await fetch(`${API_BASE}?sortBy=createdAt&order=desc`);
  const data = await res.json();
  const scripts = data.result?.scripts || [];

  document.getElementById("latest").innerHTML =
    scripts.slice(0,20).map(createCard).join("");
}

// Tìm kiếm script
async function searchScripts(keyword){
  if(!keyword) return;

  const res = await fetch(`${API_BASE}/search?q=${encodeURIComponent(keyword)}`);
  const data = await res.json();
  const scripts = data.result?.scripts || [];

  document.getElementById("results").innerHTML =
    scripts.map(createCard).join("");
}

// Sự kiện tìm kiếm
document.getElementById("searchInput").addEventListener("keydown", e=>{
  if(e.key === "Enter"){
    searchScripts(e.target.value.trim());
  }
});

loadLatest();
</script>

</body>
</html>
