<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ScriptBlox Mini ‚Äî View Script</title>
<style>
body{margin:0;font-family:Inter,Arial;background:#0b1220;color:white;padding:20px}
.header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.back{color:#38bdf8;cursor:pointer}
h2{margin:10px 0}
.meta{color:#94a3b8;margin-bottom:10px}
pre{background:#1e293b;padding:15px;border-radius:10px;overflow:auto;max-height:60vh}
button{margin-top:10px;padding:10px 15px;border:none;border-radius:8px;background:#22c55e;color:white;cursor:pointer}
a.openLink{display:inline-block;margin-left:10px;padding:8px 10px;border-radius:8px;background:#0b1620;color:#94a3b8;text-decoration:none}
</style>
</head>
<body>

<div class="header">
  <div class="back" onclick="history.back()">‚Üê Quay l·∫°i</div>
  <div style="flex:1"></div>
</div>

<h2 id="title">ƒêang t·∫£i...</h2>
<div id="info" class="meta"></div>

<pre id="code">...</pre>
<div>
  <button id="btnCopy">Copy Script</button>
  <a id="openOnScriptBlox" class="openLink" target="_blank" rel="noopener">M·ªü tr√™n ScriptBlox</a>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const id = params.get("id");

async function load(){
    if(!id){ document.getElementById("title").innerText = 'ID kh√¥ng h·ª£p l·ªá'; return; }
    try{
        const res = await fetch(`https://scriptblox.com/api/script/${id}`);
        if(!res.ok) throw new Error('HTTP ' + res.status);
        const data = await res.json();
        const s = data.script || data.result || {};
        document.getElementById("title").innerText = s.title || '‚Äî';
        document.getElementById("info").innerText = `Game: ${s.game?.name || '-'} | T√°c gi·∫£: ${s.owner?.username || '-'} | üëÅ ${s.views || 0}`;
        document.getElementById("code").innerText = s.script || '[Kh√¥ng c√≥ script]';
        document.getElementById("openOnScriptBlox").href = `https://scriptblox.com/script/${s.slug || s._id || id}`;
        document.getElementById("btnCopy").onclick = ()=>{ navigator.clipboard.writeText(s.script||''); alert('ƒê√£ copy!'); };
    }catch(e){
        console.error(e);
        document.getElementById("title").innerText = 'L·ªói t·∫£i script';
        document.getElementById("code").innerText = e.message;
    }
}

load();

// register service worker (optional but recommended)
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js').catch(()=>{/* ignore */});
}
</script>

</body>
</html>
